<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Comment Delete UI Logic</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f2f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .post {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #1877f2;
        }
        .comment {
            background: #f0f2f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 3px solid #42a5f5;
        }
        .reply {
            background: #e3f2fd;
            padding: 8px;
            margin: 8px 0 8px 20px;
            border-radius: 6px;
            border-left: 2px solid #90caf9;
        }
        .comment-author {
            font-weight: bold;
            color: #1877f2;
            font-size: 14px;
        }
        .comment-content {
            margin: 5px 0;
            font-size: 14px;
        }
        .comment-actions {
            margin-top: 8px;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .action-btn {
            background: transparent;
            border: none;
            color: #65676b;
            font-size: 12px;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        .action-btn:hover {
            background: #e4e6ea;
        }
        .delete-btn {
            color: #e74c3c !important;
        }
        .delete-btn:hover {
            background: #fdf2f2 !important;
        }
        .hidden {
            display: none;
        }
        .permission-info {
            background: #e8f5e8;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            color: #2e7d32;
            margin-top: 5px;
        }
        .no-permission {
            background: #fff3e0;
            color: #f57c00;
        }
        .user-selector {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .user-selector select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            margin-left: 10px;
        }
        .test-case {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid #28a745;
        }
        .test-result {
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Test Comment Delete UI Logic</h1>
    
    <div class="user-selector">
        <strong>Ch·ªçn ng∆∞·ªùi d√πng hi·ªán t·∫°i:</strong>
        <select id="currentUser" onchange="updateCurrentUser()">
            <option value="1">Nguy·ªÖn VƒÉn A (ID: 1) - Ch·ªß b√†i vi·∫øt</option>
            <option value="2">Tr·∫ßn Th·ªã B (ID: 2) - Ng∆∞·ªùi kh√°c</option>
            <option value="3">L√™ VƒÉn C (ID: 3) - Ng∆∞·ªùi kh√°c</option>
        </select>
    </div>

    <div class="test-section">
        <h2>M√¥ ph·ªèng giao di·ªán comment v·ªõi logic ph√¢n quy·ªÅn</h2>
        <p><strong>Logic:</strong> N√∫t "X√≥a" ch·ªâ hi·ªÉn th·ªã khi ng∆∞·ªùi d√πng l√† ch·ªß comment HO·∫∂C ch·ªß b√†i vi·∫øt</p>
    </div>

    <div class="post">
        <div class="comment-author">üìù B√†i vi·∫øt c·ªßa: Nguy·ªÖn VƒÉn A (ID: 1)</div>
        <div class="comment-content">ƒê√¢y l√† n·ªôi dung b√†i vi·∫øt m·∫´u ƒë·ªÉ test logic x√≥a comment.</div>
        
        <!-- Comment 1: C·ªßa ch·ªß b√†i vi·∫øt -->
        <div class="comment" data-comment-id="1" data-author-id="1">
            <div class="comment-author">üí¨ Nguy·ªÖn VƒÉn A (ID: 1) - Ch·ªß b√†i vi·∫øt</div>
            <div class="comment-content">Comment c·ªßa ch·ªß b√†i vi·∫øt</div>
            <div class="comment-actions">
                <button class="action-btn">Th√≠ch</button>
                <button class="action-btn">Tr·∫£ l·ªùi</button>
                <button class="action-btn delete-btn" onclick="testDelete(1, 1)">X√≥a</button>
            </div>
            <div class="permission-info" id="permission-1">
                ‚úÖ C√≥ quy·ªÅn x√≥a (Ch·ªß comment)
            </div>
        </div>

        <!-- Comment 2: C·ªßa ng∆∞·ªùi kh√°c -->
        <div class="comment" data-comment-id="2" data-author-id="2">
            <div class="comment-author">üí¨ Tr·∫ßn Th·ªã B (ID: 2) - Ng∆∞·ªùi kh√°c</div>
            <div class="comment-content">Comment c·ªßa ng∆∞·ªùi kh√°c</div>
            <div class="comment-actions">
                <button class="action-btn">Th√≠ch</button>
                <button class="action-btn">Tr·∫£ l·ªùi</button>
                <button class="action-btn delete-btn" onclick="testDelete(2, 2)">X√≥a</button>
            </div>
            <div class="permission-info" id="permission-2">
                ‚úÖ C√≥ quy·ªÅn x√≥a (Ch·ªß comment)
            </div>
            
            <!-- Reply 1: C·ªßa ch·ªß b√†i vi·∫øt -->
            <div class="reply" data-comment-id="3" data-author-id="1">
                <div class="comment-author">‚Ü≥ Nguy·ªÖn VƒÉn A (ID: 1) - Ch·ªß b√†i vi·∫øt</div>
                <div class="comment-content">Ph·∫£n h·ªìi c·ªßa ch·ªß b√†i vi·∫øt</div>
                <div class="comment-actions">
                    <button class="action-btn">Th√≠ch</button>
                    <button class="action-btn">Ph·∫£n h·ªìi</button>
                    <button class="action-btn delete-btn" onclick="testDelete(3, 1)">X√≥a</button>
                </div>
                <div class="permission-info" id="permission-3">
                    ‚úÖ C√≥ quy·ªÅn x√≥a (Ch·ªß comment)
                </div>
            </div>
        </div>

        <!-- Comment 3: C·ªßa ng∆∞·ªùi kh√°c -->
        <div class="comment" data-comment-id="4" data-author-id="3">
            <div class="comment-author">üí¨ L√™ VƒÉn C (ID: 3) - Ng∆∞·ªùi kh√°c</div>
            <div class="comment-content">Comment c·ªßa ng∆∞·ªùi kh√°c</div>
            <div class="comment-actions">
                <button class="action-btn">Th√≠ch</button>
                <button class="action-btn">Tr·∫£ l·ªùi</button>
                <button class="action-btn delete-btn" onclick="testDelete(4, 3)">X√≥a</button>
            </div>
            <div class="permission-info" id="permission-4">
                ‚úÖ C√≥ quy·ªÅn x√≥a (Ch·ªß comment)
            </div>
        </div>
    </div>

    <div class="test-section">
        <h3>K·∫øt qu·∫£ test</h3>
        <div id="test-results"></div>
    </div>

    <script>
        let currentUserId = 1; // M·∫∑c ƒë·ªãnh l√† ch·ªß b√†i vi·∫øt

        function updateCurrentUser() {
            currentUserId = parseInt(document.getElementById('currentUser').value);
            updateDeleteButtons();
            runTests();
        }

        function canDeleteComment(commentAuthorId) {
            const postAuthorId = 1; // Ch·ªß b√†i vi·∫øt lu√¥n l√† ID 1
            return commentAuthorId === currentUserId || currentUserId === postAuthorId;
        }

        function updateDeleteButtons() {
            const comments = document.querySelectorAll('.comment, .reply');
            
            comments.forEach(comment => {
                const commentId = comment.dataset.commentId;
                const authorId = parseInt(comment.dataset.authorId);
                const deleteBtn = comment.querySelector('.delete-btn');
                const permissionInfo = comment.querySelector('.permission-info');
                
                const canDelete = canDeleteComment(authorId);
                
                if (canDelete) {
                    deleteBtn.classList.remove('hidden');
                    permissionInfo.textContent = `‚úÖ C√≥ quy·ªÅn x√≥a (${authorId === currentUserId ? 'Ch·ªß comment' : 'Ch·ªß b√†i vi·∫øt'})`;
                    permissionInfo.className = 'permission-info';
                } else {
                    deleteBtn.classList.add('hidden');
                    permissionInfo.textContent = '‚ùå Kh√¥ng c√≥ quy·ªÅn x√≥a';
                    permissionInfo.className = 'permission-info no-permission';
                }
            });
        }

        function testDelete(commentId, authorId) {
            const canDelete = canDeleteComment(authorId);
            const result = canDelete ? '‚úÖ TH√ÄNH C√îNG' : '‚ùå TH·∫§T B·∫†I';
            const reason = canDelete ? 
                (authorId === currentUserId ? 'Ch·ªß comment' : 'Ch·ªß b√†i vi·∫øt') : 
                'Kh√¥ng c√≥ quy·ªÅn';
            
            const resultHtml = `
                <div class="test-case">
                    <strong>Test x√≥a comment ${commentId}</strong><br>
                    <strong>K·∫øt qu·∫£:</strong> ${result}<br>
                    <strong>L√Ω do:</strong> ${reason}<br>
                    <strong>Chi ti·∫øt:</strong> 
                    - Ng∆∞·ªùi x√≥a: ID ${currentUserId}
                    - Ch·ªß comment: ID ${authorId}
                    - Ch·ªß b√†i vi·∫øt: ID 1
                </div>
            `;
            
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = resultHtml + resultsDiv.innerHTML;
        }

        function runTests() {
            const testCases = [
                { commentId: 1, authorId: 1, description: 'Ch·ªß b√†i vi·∫øt x√≥a comment c·ªßa ch√≠nh m√¨nh' },
                { commentId: 2, authorId: 2, description: 'Ch·ªß b√†i vi·∫øt x√≥a comment c·ªßa ng∆∞·ªùi kh√°c' },
                { commentId: 3, authorId: 1, description: 'Ch·ªß b√†i vi·∫øt x√≥a reply c·ªßa ch√≠nh m√¨nh' },
                { commentId: 4, authorId: 3, description: 'Ch·ªß b√†i vi·∫øt x√≥a comment c·ªßa ng∆∞·ªùi kh√°c' }
            ];

            let resultsHtml = '<h4>Test Cases:</h4>';
            
            testCases.forEach(testCase => {
                const canDelete = canDeleteComment(testCase.authorId);
                const resultClass = canDelete ? 'success' : 'error';
                const resultText = canDelete ? '‚úÖ PASS' : '‚ùå FAIL';
                
                resultsHtml += `
                    <div class="test-result ${resultClass}">
                        <strong>${testCase.description}</strong><br>
                        K·∫øt qu·∫£: ${resultText}<br>
                        Comment ID: ${testCase.commentId}, Author ID: ${testCase.authorId}
                    </div>
                `;
            });
            
            document.getElementById('test-results').innerHTML = resultsHtml;
        }

        // Kh·ªüi t·∫°o khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            updateDeleteButtons();
            runTests();
        });
    </script>
</body>
</html>
